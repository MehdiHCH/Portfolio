<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by yousinix
  Free for personal and commercial use under the MIT license
  https://github.com/yousinix/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="E2E-Spot - Temporal Event Detection in Sports Videos">
  <meta property="og:description" content="End-to-end architecture for precise temporal event detection in futsal videos using RegNet-Y, Gate Shift Modules, and Bidirectional GRU for ultra-precise act...">
  <meta property="og:image" content="/assets/img/projects/e2e_spot.jpg">

  <title>E2E-Spot - Temporal Event Detection in Sports Videos</title>
  <meta name="description" content="End-to-end architecture for precise temporal event detection in futsal videos using RegNet-Y, Gate Shift Modules, and Bidirectional GRU for ultra-precise act...">

  <link rel="shortcut icon" type="image/x-icon" href="/Portfolio/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/Portfolio/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/Portfolio/assets/css/style.css">

</head>


<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/Portfolio/"><h5><b>Hicham El Mehdi</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link active" href="/Portfolio/projects/">My Projects</a>

      <a class="nav-item nav-link " href="/Portfolio/demos/">Demos</a>

      <a class="nav-item nav-link " href="/Portfolio/demos/futsal-analysis-demos.html">Futsal Analysis - Demos</a>

      <a class="nav-item nav-link " href="/Portfolio/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <style>
.project-detail {
  max-width: 900px;
  margin: 0 auto;
  padding: 3rem 2rem;
}

.project-header {
  text-align: center;
  margin-bottom: 3rem;
}

.project-header h1 {
  font-size: 2.5rem;
  font-weight: 700;
  background: linear-gradient(135deg, #58a6ff, #238636);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 1rem;
}

.project-meta {
  display: flex;
  justify-content: center;
  gap: 2rem;
  color: #9ba3b4;
  margin-bottom: 2rem;
}

.project-hero-image {
  width: 100%;
  max-height: 500px;
  object-fit: cover;
  border-radius: 16px;
  margin-bottom: 2rem;
}

.project-tags-detail {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
  margin-bottom: 2rem;
}

.project-tag-detail {
  padding: 0.5rem 1rem;
  background: rgba(88, 166, 255, 0.15);
  border: 1px solid rgba(88, 166, 255, 0.3);
  border-radius: 12px;
  font-size: 0.9rem;
  color: #58a6ff;
}

.project-actions {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin-bottom: 3rem;
}

.project-action-btn {
  padding: 0.8rem 1.5rem;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 600;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.btn-github {
  background: rgba(35, 134, 54, 0.1);
  border: 1px solid rgba(35, 134, 54, 0.3);
  color: #238636;
}

.btn-github:hover {
  background: rgba(35, 134, 54, 0.2);
  transform: translateY(-2px);
}

.btn-demo {
  background: rgba(88, 166, 255, 0.1);
  border: 1px solid rgba(88, 166, 255, 0.3);
  color: #58a6ff;
}

.btn-demo:hover {
  background: rgba(88, 166, 255, 0.2);
  transform: translateY(-2px);
}

.project-content {
  color: #e6edf3;
  line-height: 1.8;
}

.project-content h2 {
  color: #58a6ff;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

.project-content h3 {
  color: #9ba3b4;
  margin-top: 1.5rem;
}

.project-content ul, .project-content ol {
  margin-left: 1.5rem;
  color: #9ba3b4;
}

.back-link {
  text-align: center;
  margin-top: 3rem;
}

.back-link a {
  color: #58a6ff;
  text-decoration: none;
  font-weight: 600;
}

.back-link a:hover {
  text-decoration: underline;
}
</style>

<article class="project-detail">
  <header class="project-header">
    <h1>E2E-Spot - Temporal Event Detection in Sports Videos</h1>
    
    <div class="project-meta">
      
      <span>üìÖ January 2025</span>
      
      <span>üìÇ Sports analytics</span>
    </div>

    
    <img src="/Portfolio/assets/img/projects/e2e_spot.jpg" alt="E2E-Spot - Temporal Event Detection in Sports Videos" class="project-hero-image">
    

    
    <div class="project-tags-detail">
      
      <span class="project-tag-detail">Computer Vision</span>
      
      <span class="project-tag-detail">Action Spotting</span>
      
      <span class="project-tag-detail">RegNet-Y</span>
      
      <span class="project-tag-detail">Deep Learning</span>
      
      <span class="project-tag-detail">Temporal Detection</span>
      
      <span class="project-tag-detail">Sports Analytics</span>
      
    </div>
    

    <div class="project-actions">
      

      
      <a href="/assets/videos/e2e_spot_demo.mp4" target="_blank" rel="noopener" class="project-action-btn btn-demo">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
          <path d="M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445z"/>
        </svg>
        Voir la d√©mo
      </a>
      
    </div>
  </header>

  <div class="project-content">
    <h2 id="-project-overview">üéØ Project Overview</h2>

<p><strong>E2E-Spot</strong> is an end-to-end architecture for <strong>precise temporal event detection</strong> in sports videos. The system automatically detects key actions (passes, dribbles, shots) at frame-level in futsal matches.</p>

<p><strong>Team:</strong> Hicham EL MEHDI &amp; Mohammed Imrane GRICH<br />
<strong>Supervised by:</strong> Prof. Noureddine MOHTARAM</p>

<p><strong>Key Achievement:</strong> <strong>93% recall</strong> for dribble detection with a lightweight architecture (10M parameters).</p>

<hr />

<h2 id="-problem-statement">üîç Problem Statement</h2>

<h3 id="challenges">Challenges</h3>
<ul>
  <li>‚è±Ô∏è <strong>Ultra-precise temporal detection</strong> at frame level (¬±1 second)</li>
  <li>üéØ <strong>Contextual understanding</strong> to differentiate similar actions</li>
  <li>üîÑ <strong>Temporal relationships</strong> across long sequences</li>
  <li>üí∞ <strong>Computational efficiency</strong> for fast video processing</li>
</ul>

<h3 id="solution">Solution</h3>
<p>End-to-end architecture combining:</p>
<ul>
  <li><strong>RegNet-Y:</strong> Efficient visual feature extraction</li>
  <li><strong>Gate Shift Modules (GSM):</strong> Local temporal modeling</li>
  <li><strong>Bidirectional GRU:</strong> Global temporal reasoning</li>
  <li><strong>Frame-by-frame classification</strong> with background detection</li>
</ul>

<hr />

<h2 id="Ô∏è-technical-architecture">üèóÔ∏è Technical Architecture</h2>

<div align="center">

![E2E-Spot Pipeline Architecture](/assets/img/projects/e2e_spot_architecture.jpg)

**Figure 1: Complete E2E-Spot Pipeline**

</div>

<hr />

<h3 id="-key-components">üîß Key Components</h3>

<table>
<tr>
<td width="50%" valign="top">

#### **Module F: Feature Extraction**

![Gate Shift Modules](/assets/img/projects/e2e_spot_gsm.png)

**RegNet-Y + Gate Shift Modules**
- ‚ö° Lightweight: **10M parameters** (vs 25M ResNet-50)
- üîÑ GSM capture variations between adjacent frames
- üöÄ Ultra-efficient single-pass processing

</td>
<td width="50%" valign="top">

#### **Module G: Temporal Reasoning**

![GRU Bidirectional](/assets/img/projects/e2e_spot_gru.png)

**Bidirectional GRU**
- üìä Models **past + future** context
- üéØ Global temporal understanding
- üìà Frame-wise classification with confidence scores

</td>
</tr>
</table>

<hr />

<h3 id="-architecture-flow">üìê Architecture Flow</h3>

<pre><code class="language-mermaid">graph LR
    A[üé• Video Frames] --&gt; B[RegNet-Y CNN]
    B --&gt; C[Gate Shift Modules]
    C --&gt; D[Feature Maps]
    D --&gt; E[Bidirectional GRU]
    E --&gt; F[Frame Predictions]
    F --&gt; G[üìä Events Timeline]
    
    style A fill:#e1f5ff
    style G fill:#d4edda
    style E fill:#fff3cd
</code></pre>

<div align="center">

**Input:** RGB frame sequence (Xt-50 ... Xt ... Xt+50)  
‚Üì  
**Processing:** RegNet-Y + GSM ‚Üí Features ‚Üí Bidirectional GRU  
‚Üì  
**Output:** [PASS | DRIVE | SHOT | Background] per frame

</div>

<hr />

<h2 id="-dataset--preprocessing">üì¶ Dataset &amp; Preprocessing</h2>

<p><strong>Source:</strong> FIFA Futsal World Cup 2024<br />
<strong>Volume:</strong> 40 GB video data<br />
<strong>Content:</strong> 7 complete matches (14 halves)</p>

<h3 id="preprocessing-pipeline">Preprocessing Pipeline</h3>
<ol>
  <li>Frame extraction at 30 FPS</li>
  <li>Temporal normalization (timestamps ‚Üí seconds)</li>
  <li>Augmentation: Jittering, cropping, mixup</li>
  <li>Split: 70% train / 15% val / 15% test</li>
</ol>

<hr />

<h2 id="-training-configurations">üöÄ Training Configurations</h2>

<h3 id="configuration-1-regnet-y-clip_len50">Configuration 1: RegNet-Y (clip_len=50)</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Model</span><span class="pi">:</span> <span class="s">rny008_gsm</span>
<span class="na">Clip Length</span><span class="pi">:</span> <span class="s">50 frames (long sequences)</span>
<span class="na">Training Time</span><span class="pi">:</span> <span class="s">8h 20min</span>
</code></pre></div></div>

<h3 id="configuration-2-resnet-50-clip_len16">Configuration 2: ResNet-50 (clip_len=16)</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Model</span><span class="pi">:</span> <span class="s">rn50</span>
<span class="na">Clip Length</span><span class="pi">:</span> <span class="s">16 frames</span>
<span class="na">Training Time</span><span class="pi">:</span> <span class="s">300h (~12.5 days)</span>
</code></pre></div></div>

<h3 id="configuration-3-regnet-y-clip_len16-">Configuration 3: RegNet-Y (clip_len=16) ‚≠ê</h3>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Model</span><span class="pi">:</span> <span class="s">rny008_gsm</span>
<span class="na">Clip Length</span><span class="pi">:</span> <span class="s">16 frames (best tradeoff)</span>
<span class="na">Training Time</span><span class="pi">:</span> <span class="s">450h (~18.7 days)</span>
</code></pre></div></div>

<table>
  <tbody>
    <tr>
      <td><strong>Hardware:</strong> NVIDIA RTX 4060 (8GB)</td>
      <td>AMD Ryzen 7 5700X</td>
      <td>32GB RAM</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-results--performance">üìä Results &amp; Performance</h2>

<h3 id="best-configuration-regnet-y-clip_len16">Best Configuration: RegNet-Y (clip_len=16)</h3>

<table>
  <thead>
    <tr>
      <th>Class</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>PASS</strong></td>
      <td>0.76</td>
      <td>0.04</td>
      <td>0.08</td>
    </tr>
    <tr>
      <td><strong>DRIVE</strong></td>
      <td>0.22</td>
      <td><strong>0.93</strong></td>
      <td><strong>0.36</strong></td>
    </tr>
    <tr>
      <td><strong>Overall</strong></td>
      <td>0.49</td>
      <td>0.49</td>
      <td>0.22</td>
    </tr>
  </tbody>
</table>

<h3 id="key-insights">Key Insights</h3>
<ul>
  <li>üèÜ <strong>93% Recall for DRIVE:</strong> Detects almost all dribbles</li>
  <li>üéØ <strong>Good PASS precision (0.76)</strong> but low recall (class imbalance)</li>
  <li>‚ö° <strong>Lightweight architecture:</strong> 2.5x fewer parameters than ResNet-50</li>
  <li>üìà <strong>Best tradeoff</strong> performance/efficiency</li>
</ul>

<h3 id="benchmark-comparison">Benchmark Comparison</h3>

<table>
  <thead>
    <tr>
      <th>Model</th>
      <th>Recall DRIVE</th>
      <th>F1-Score</th>
      <th>Parameters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>E2E-Spot (RegNet-Y)</strong></td>
      <td><strong>0.93</strong></td>
      <td><strong>0.36</strong></td>
      <td>10M</td>
    </tr>
    <tr>
      <td>ResNet-50</td>
      <td>0.55</td>
      <td>0.32</td>
      <td>25M</td>
    </tr>
    <tr>
      <td>RegNet-Y (clip=50)</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>10M</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="Ô∏è-challenges--solutions">üõ†Ô∏è Challenges &amp; Solutions</h2>

<h3 id="challenge-1-class-imbalance">Challenge 1: Class Imbalance</h3>
<p><strong>Problem:</strong> PASS class underrepresented ‚Üí low recall<br />
<strong>Solution:</strong> Weighted Cross-Entropy Loss, PASS oversampling</p>

<h3 id="challenge-2-training-time">Challenge 2: Training Time</h3>
<p><strong>Problem:</strong> 450h for optimal config<br />
<strong>Solution:</strong> Checkpointing, Mixed Precision (FP16), Gradient Accumulation</p>

<h3 id="challenge-3-temporal-capture">Challenge 3: Temporal Capture</h3>
<p><strong>Problem:</strong> clip_len=50 too long, clip_len=16 sometimes insufficient<br />
<strong>Future Solution:</strong> Multi-scale temporal fusion (8/16/32 frames)</p>

<hr />

<h2 id="-future-improvements">üîÆ Future Improvements</h2>

<p><strong>Short-Term:</strong></p>
<ul>
  <li>Focal Loss for class imbalance</li>
  <li>Multi-scale temporal fusion</li>
  <li>Temporal NMS post-processing</li>
</ul>

<p><strong>Long-Term:</strong></p>
<ul>
  <li>Transformer architecture for very long-term relationships</li>
  <li>Real-time inference (&lt;100ms latency)</li>
  <li>Multi-sport generalization (basketball, handball)</li>
</ul>

<hr />

<h2 id="-impact--value">üíº Impact &amp; Value</h2>

<h3 id="for-sports-analytics">For Sports Analytics</h3>
<p>‚úÖ <strong>70% reduction</strong> in manual annotation time<br />
‚úÖ <strong>Frame-precise detection</strong> (¬±1 second)<br />
‚úÖ <strong>Lightweight architecture</strong> = reduced infrastructure costs</p>

<h3 id="for-coaches--media">For Coaches &amp; Media</h3>
<p>‚úÖ <strong>Fast post-match analysis</strong><br />
‚úÖ <strong>Automatic highlight generation</strong><br />
‚úÖ <strong>Video indexing</strong> for event search</p>

<hr />

<h2 id="Ô∏è-technical-stack">üõ†Ô∏è Technical Stack</h2>

<p><strong>Deep Learning:</strong> PyTorch, TorchVision, Lightning<br />
<strong>Computer Vision:</strong> OpenCV, Albumentations<br />
<strong>Models:</strong> RegNet-Y, Gate Shift Modules, GRU<br />
<strong>Tools:</strong> Weights &amp; Biases, TensorBoard<br />
<strong>Hardware:</strong> NVIDIA RTX 4060, AMD Ryzen 7 5700X</p>

<hr />

<h2 id="-skills-developed">üéì Skills Developed</h2>

<ul>
  <li><strong>Deep Learning:</strong> End-to-end architecture, temporal modeling</li>
  <li><strong>Computer Vision:</strong> Video understanding, action spotting</li>
  <li><strong>Model Optimization:</strong> Hyperparameter tuning, loss functions</li>
  <li><strong>Research:</strong> Experimentation, benchmarking, technical writing</li>
</ul>

<hr />

<h2 id="-contact">üìß Contact</h2>

<p><strong>Author:</strong> Hicham El Mehdi<br />
<strong>Email:</strong> mehdihicham736@gmail.com<br />
<strong>LinkedIn:</strong> <a href="https://linkedin.com/in/elmehdihicham">linkedin.com/in/elmehdihicham</a><br />
<strong>GitHub:</strong> <a href="https://github.com/MehdiHCH">github.com/MehdiHCH</a></p>

<p><strong>Co-Author:</strong> Mohammed Imrane GRICH<br />
<strong>Supervisor:</strong> Prof. Noureddine MOHTARAM</p>

<hr />

<h2 id="-key-references">üìö Key References</h2>

<ol>
  <li><strong>RegNet</strong> (Radosavovic et al., 2020) - Designing Network Design Spaces</li>
  <li><strong>Gate Shift Modules</strong> (Sudhakaran et al., 2020) - CVPR 2020</li>
  <li><strong>E2E-Spot</strong> (Giancola et al., 2022) - End-to-End Spotting in Soccer</li>
</ol>

<hr />

<p><em>Compact and efficient end-to-end architecture for temporal event detection in sports videos, achieving 93% recall with only 10M parameters.</em></p>

  </div>

  <div class="back-link">
    <a href="/Portfolio/projects/">‚Üê Retour aux projets</a>
  </div>
</article>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>EL MEHDI Hicham</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:mehdihicham736@gmail.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/MehdiHCH"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/elmehdihicham"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div><small id="attribution">
    theme <a href="https://github.com/yousinix/portfolYOU">portfolYOU</a>
  </small>

</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>